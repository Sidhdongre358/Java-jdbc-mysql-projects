package com.main;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

public class App 
{
	private static final String URL="jdbc:mysql://127.0.0.1:3306/customerdb";
	private static final String USERNAME="user1234";
	private static final String PASSWORD="admin1234";
	
	
    public static void main( String[] args )
    {
        System.out.println( "How to insert the Data the DB" );
        
        
        try (Connection connection = DriverManager.getConnection(URL,USERNAME,PASSWORD)){
        	System.out.println("Connected to DB...!");
        	
        	// inserting data into the table 
        	
        //	insertData(connection,"Parth","777888551","parth@gmail.com");
        //	insertData(connection, "Arun", "00000023", "arun@gmail.com");
        	
        	insertData(connection, "John", "777884443", "john@gmail.com");
        	insertData(connection, "Perry", "99900077", "perry@gmail.com");

        	
        	// Executing a query to fetch all the record from the Table
        	try{
        		Statement statement=connection.createStatement();
        		ResultSet resultSet=statement.executeQuery("SELECT * FROM customertable");
        		
        		// Processing the result 
        		while(resultSet.next()) {
        	int id = resultSet.getInt("id");
        	String name= resultSet.getString("name");
        	String phoneNumber = resultSet.getString("phone_number");
        	String emailAddress= resultSet.getString("email_address");
        	
        	System.out.println(".......................................................");
        	
        	System.out.println("Customer data : " 
        			+ " Id : " + id
        			+ " Name : "+ name 
        			+ " Phone Number : "+ phoneNumber
        			+ " Email Address : "+emailAddress			
        			);
        		}
        		
        		
        		
        	}catch(SQLException e) {
        		System.out.println("Failed to fetch the data from the table... Message : "+e.getMessage());
        		
        	}
        	
        	
        	
			
		} catch (SQLException e) {
        	System.out.println("Failed to connect to DB...! message : " + e.getMessage());

		}
    }
    
    
    
    // Method to insert data into the table 
    
    private static void insertData(Connection connection,String name, String phoneNumber , String emailAddress) {
    
    	String sql="INSERT INTO customertable(name, phone_number,email_address)VALUES(?,?,?)";
    	
    	try {
    		PreparedStatement pStmt =connection.prepareStatement(sql);
    		
    		pStmt.setString(1, name);
    		pStmt.setString(2, phoneNumber);
    		pStmt.setString(3, emailAddress);
    		 
    	   int rowsAffected=pStmt.executeUpdate();
    		
    		System.out.println(rowsAffected +" row(s) inserted. ");
    		
		} catch (SQLException e) {
			System.out.println("Failed to update the data into table.. Message : "+e.getMessage());
		}
    	
    	
    }
}
